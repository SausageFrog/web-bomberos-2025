<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Compañías – Cuerpo de Bomberos de Temuco</title>
    <meta name="description" content="Listado de compañías del Cuerpo de Bomberos de Temuco con enlaces oficiales e institucionales." />
    <style>
      :root{--bg:#0b0b0c;--panel:#111214;--border:#232428;--text:#fff;--muted:#a3a3a3;--accent:#ef4444}
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;background:linear-gradient(180deg,#0b0b0c,#141518);color:var(--text)}
      header,main{max-width:1100px;margin:0 auto;padding:16px}
      h1{margin:0 0 8px 0;font-size:22px}
      p.muted{margin:0;color:var(--muted)}
      .toolbar{display:flex;gap:12px;align-items:center;margin-top:12px}
      .field{display:flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:8px;padding:8px 10px;background:#0f1012;flex:1}
      .field input{flex:1;background:transparent;border:0;outline:0;color:#fff;font-size:14px}
      .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));margin-top:16px}
      .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
      .card img{width:100%;aspect-ratio:4/3;object-fit:cover;background:#0f1012}
      .card .body{padding:10px}
      .card h3{margin:0 0 6px 0;font-size:16px}
      .links{display:flex;gap:8px;flex-wrap:wrap}
      .btn{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:#181a1e;color:#fff;text-decoration:none}
      .footer{text-align:center;color:var(--muted);padding:16px}
    </style>
  </head>
  <body>
    <header>
      <h1>Compañías del Cuerpo de Bomberos de Temuco</h1>
      <p class="muted">Fotos y enlaces oficiales · Búsqueda por número o nombre</p>
      <div class="toolbar">
        <div class="field" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 21L15.8033 15.8033M18 10.5C18 14.0899 15.0899 17 11.5 17C7.91015 17 5 14.0899 5 10.5C5 6.91015 7.91015 4 11.5 4C15.0899 4 18 6.91015 18 10.5Z" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <input id="q" type="text" placeholder="Buscar: 1, Primera, Sexta… (/, Esc)" aria-label="Buscar compañía" />
        </div>
        <a class="btn" href="/" rel="noopener">← Volver</a>
      </div>
    </header>
    <main>
      <div id="list" class="grid" aria-live="polite"></div>
    </main>
    <div class="footer">Fuente: Cuerpo de Bomberos de Temuco (datos demostrativos)</div>

    <script>
      const $ = (s,r=document)=>r.querySelector(s);
      const escapeHTML = (s)=>String(s).replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]));
      function stripAccents(str){ try{ return str.normalize('NFD').replace(/\p{Diacritic}/gu,''); } catch{ return str; } }
      function norm(s){ return stripAccents(String(s||'').trim().toLowerCase()); }

      async function load(){
        let data;
        try {
          const res = await fetch('/data/companias.temuco.json', { cache: 'force-cache' });
          data = await res.json();
        } catch {
          data = { companies: [] };
        }
        const input = $('#q');
        const list = $('#list');
        function render(filter=''){
          const f = norm(filter);
          const items = (data.companies||[]).filter(c => {
            return !f || norm(c.name).includes(f) || String(c.num).startsWith(f);
          });
          list.innerHTML = items.map(c => cardHTML(c)).join('') || `<p class="muted">Sin resultados</p>`;
        }
        function cardHTML(c){
          const photo = escapeHTML(c.photo || '/assets/companias/placeholder.jpg');
          const name = escapeHTML(c.name || 'Compañía');
          const num = escapeHTML(c.num);
          const official = c.official ? `<a class="btn" href="${escapeHTML(c.official)}" target="_blank" rel="noopener">Sitio oficial</a>` : '';
          const inst = c.institutional ? `<a class="btn" href="${escapeHTML(c.institutional)}" target="_blank" rel="noopener">Ver en sitio institucional</a>` : '';
          return `<article class="card" aria-label="${name}">
            <img loading="lazy" src="${photo}" alt="${name} – foto" />
            <div class="body">
              <h3>${num}. ${name}</h3>
              <div class="links">${official}${inst}</div>
            </div>
          </article>`;
        }
        document.addEventListener('keydown', (e)=>{ if(e.key=='/'){ e.preventDefault(); $('#q').focus(); } if(e.key=='Escape'){ input.value=''; render(''); }});
        input.addEventListener('input', ()=> render(input.value));
        render('');
      }
      load();
    </script>
  </body>
  </html>

